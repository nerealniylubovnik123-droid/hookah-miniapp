<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Telegram SDK v3</title>
  <style>
    body {
      background: #000;
      color: #0f0;
      font-family: monospace;
      padding: 10px;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h2>üîç –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Telegram SDK (v3)</h2>
  <div id="log">–ó–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏...</div>

  <script>
    const logEl = document.getElementById("log");
    function log(msg) {
      const time = new Date().toLocaleTimeString();
      logEl.textContent += `\n[${time}] ${msg}`;
    }

    function safe(fn) {
      try { return fn(); } catch { return undefined; }
    }

    function updateDiagnostics() {
      const tg = safe(() => window.Telegram);
      const webApp = safe(() => window.Telegram.WebApp);
      const initData = safe(() => webApp.initData);
      const user = safe(() => webApp.initDataUnsafe?.user);

      logEl.textContent = ""; // –æ—á–∏—â–∞–µ–º —ç–∫—Ä–∞–Ω –∫–∞–∂–¥—ã–π —Ç–∏–∫
      log("üîÅ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è...");
      log(`Telegram SDK: ${tg ? "‚úÖ –Ω–∞–π–¥–µ–Ω" : "‚ùå –Ω–µ—Ç"}`);
      log(`WebApp: ${webApp ? "‚úÖ –µ—Å—Ç—å" : "‚ùå –Ω–µ—Ç"}`);
      log(`initData: ${initData ? initData.slice(0, 50) + "..." : "‚ùå –Ω–µ—Ç"}`);
      log(`user: ${user ? JSON.stringify(user, null, 2) : "‚ùå –Ω–µ—Ç"}`);
      if (user) {
        log(`ID: ${user.id || "‚ùå –Ω–µ—Ç"} | username: ${user.username || "‚ùå –Ω–µ—Ç"}`);
      }
    }

    setInterval(updateDiagnostics, 500);
    updateDiagnostics();
  </script>
</body>
</html>
